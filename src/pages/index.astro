---
import Layout from '../layouts/Layout.astro';
import Card from '../components/Card.astro';
import SpotifyNowPlaying from '../components/SpotifyNowPlaying.astro';
import GalleryOverlay from '../components/GalleryOverlay.astro';
import FriendsOverlay from '../components/FriendsOverlay.astro';
import CommentsOverlay from '../components/CommentsOverlay.astro';
---

<Layout title="Nero's Portfolio 🐾">
  <main class="main-grid">
    <div class="status-widgets">
      <SpotifyNowPlaying />
    </div>
    <Card />
  </main>

  <GalleryOverlay />
  <FriendsOverlay />
  <CommentsOverlay />
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const handleOverlay = (buttonId, overlayId) => {
      const button = document.querySelector(`[data-overlay-button="${buttonId}"]`);
      const overlay = document.getElementById(overlayId);
      const closeButton = overlay?.querySelector('.close-button');

      if (!button || !overlay || !closeButton) return;

      button.addEventListener('click', () => overlay.classList.add('active'));
      closeButton.addEventListener('click', () => overlay.classList.remove('active'));
      overlay.addEventListener('click', (event) => {
        if (event.target === overlay) {
          overlay.classList.remove('active');
        }
      });
    };

    handleOverlay('gallery-overlay', 'gallery-overlay');
    handleOverlay('friends-overlay', 'friends-overlay');
    handleOverlay('comments-overlay', 'comments-overlay');
  });
</script>

<style is:global>
  .main-grid {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 30px;
    padding: 20px;
  }
  .status-widgets {
    width: 100%;
    max-width: 650px;
    box-sizing: border-box;
  }
</style>


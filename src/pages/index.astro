---
import Layout from '../layouts/Layout.astro';
import Card from '../components/Card.astro';
import SpotifyNowPlaying from '../components/SpotifyNowPlaying.astro';
import GalleryOverlay from '../components/GalleryOverlay.astro';
import FriendsOverlay from '../components/FriendsOverlay.astro';
import CommentsOverlay from '../components/CommentsOverlay.astro';
import EventsOverlay from '../components/EventsOverlay.astro';

let isGalleryVisible = false;
let isFriendsVisible = false;
let isCommentsVisible = false;
let isEventsVisible = false;
---

<Layout title="Nerozhen's Portfolio">
  <main class="main-grid">
    <SpotifyNowPlaying client:load />
    <Card />
  </main>
  
  <GalleryOverlay isVisible={isGalleryVisible} client:load />
  <FriendsOverlay isVisible={isFriendsVisible} client:load />
  <CommentsOverlay isVisible={isCommentsVisible} client:load />
  <EventsOverlay isVisible={isEventsVisible} client:load />
</Layout>

<script>
  function setupOverlay(buttonId, overlayId) {
    const openButton = document.querySelector(`[data-overlay-button="${buttonId}"]`);
    const overlay = document.getElementById(overlayId);
    if (!openButton || !overlay) return;

    const closeButton = overlay.querySelector(".close-button");
    const openFunc = () => overlay.classList.add("active");
    const closeFunc = () => overlay.classList.remove("active");

    openButton.addEventListener("click", openFunc);
    if (closeButton) closeButton.addEventListener("click", closeFunc);
    overlay.addEventListener("click", (event) => {
      if (event.target === overlay) closeFunc();
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    setupOverlay('gallery-overlay', 'gallery-overlay');
    setupOverlay('friends-overlay', 'friends-overlay');
    setupOverlay('comments-overlay', 'comments-overlay');
    setupOverlay('events-overlay', 'events-overlay');
  });
</script>

